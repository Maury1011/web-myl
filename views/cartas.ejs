<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cartas MyL</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="register.css">
    <link rel="stylesheet" href="filters.css"> <!-- Estilos para los filtros -->
</head>
<body>
    <div class="header">
        <h1>MyL Cartas</h1>
        <button id="openModal" class="boton">Iniciar Sesión</button>
    </div>

    <div id="modal2" class="modal2">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Iniciar Sesión o Registrarse</h2>
            <form id="userForm">
                <input type="email" id="correo" placeholder="Correo electrónico" required>
                <input type="password" id="contraseña" placeholder="Contraseña" required>
                <button class="boton2" type="submit">Continuar</button>
            </form>
        </div>
    </div>

    <!-- Filtros -->
    <div id="filters">
        <form method="get" action="/">
            <select name="edicion" id="edicion">
                <option value="">Edición</option>
                <% ediciones.forEach(edicion => { %>
                    <option value="<%= edicion.id %>" <%= edicion.id == selectedEdicion ? 'selected' : '' %>><%= edicion.nombre %></option>
                <% }); %>
            </select>
            
            <select name="tipo" id="tipo">
                <option value="">Tipo</option>
                <% tipos.forEach(tipo => { %>
                    <option value="<%= tipo.id %>" <%= tipo.id == selectedTipo ? 'selected' : '' %>><%= tipo.nombre %></option>
                <% }); %>
            </select>

            <select name="raza" id="raza">
                <option value="">Raza</option>
                <% razas.forEach(raza => { %>
                    <option value="<%= raza.id %>" <%= raza.id == selectedRaza ? 'selected' : '' %>><%= raza.nombre %></option>
                <% }); %>
            </select>

            <select name="subRaza" id="subRaza">
                <option value="">Sub Raza</option>
                <% subRazas.forEach(sub_raza => { %>
                    <option value="<%= sub_raza.id %>" <%= selectedSubRaza && selectedSubRaza.includes(sub_raza.id.toString()) ? 'selected' : '' %>>
                        <%= sub_raza.nombre %>
                    </option>
                <% }); %>
            </select>
            

            <select name="rareza" id="rareza">
                <option value="">Rareza</option>
                <% rarezas.forEach(rareza => { %>
                    <option value="<%= rareza.id %>" <%= rareza.id == selectedRareza ? 'selected' : '' %>><%= rareza.nombre %></option>
                <% }); %>
            </select>

            <button class="boton2" type="submit">Filtrar</button>
        </form>
    </div>

    <div class="cartas-container">
        <div class="cartas-list">
            <% cartas.forEach(carta => { %> 
                <img class="imagen-peque" 
                    src="/imagenes/<%= carta.Edicion ? carta.Edicion.nombre.replace(/ /g, "_") : 'default_edicion' %>/<%= carta.nombre.normalize('NFD').replace(/[\u0300-\u036f]/g, '') %>.webp" 
                    abc="<%= carta.imagen %>" 
                    alt="<%= carta.nombre %>">
            <% }); %>
        </div>
    </div>
    
    <!-- Modal para la imagen en grande -->
    <div id="modal" class="modal">
        <img class="imagen-grande" id="imagenGrande" src="" alt="Imagen en grande">
    </div>
    
    <script>
        var modal = document.getElementById("modal");
        var imagenGrande = document.getElementById("imagenGrande");
    
        var imagenes = document.querySelectorAll('.imagen-peque');
        imagenes.forEach(function(imagen) {
            imagen.onclick = function() {
                var imagenSrc = imagen.getAttribute('abc');
                imagenGrande.src = imagenSrc;
                modal.style.display = "block";
            }
        });
    
        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }
    </script>

    <script>
        const modal2 = document.getElementById("modal2");
        const openModalBtn = document.getElementById("openModal");
        const closeModalBtn = document.querySelector(".close");

        openModalBtn.addEventListener("click", () => {
            modal2.style.display = "flex";
        });

        closeModalBtn.addEventListener("click", () => {
            modal2.style.display = "none";
        });

        window.addEventListener("click", (event) => {
            if (event.target === modal2) {
                modal2.style.display = "none";
            }
        });
    </script>
</body>
</html>
